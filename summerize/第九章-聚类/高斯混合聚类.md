# 高斯混合聚类（Gaussian Mixture Clustering, GMM）原理与推导

## 1. 高斯混合模型的生成过程
- 假设数据点 $x$ 来自 $k$ 个高斯分布的加权混合。
- 每个高斯分布称为一个“分量”，其参数为均值 $\mu_i$ 和协方差矩阵 $\Sigma_i$。
- $\alpha_i$ 是第 $i$ 个分量的权重（先验概率），满足 $\sum_{i=1}^k \alpha_i = 1$。

生成样本的过程：
1. 先以概率 $\alpha_i$ 选择第 $i$ 个高斯分量。
2. 再从该分量的高斯分布 $\mathcal{N}(\mu_i, \Sigma_i)$ 采样得到 $x$。

因此，混合模型的概率密度为：
$$
p_{\mathcal{M}}(x) = \sum_{i=1}^k \alpha_i \cdot p(x|\mu_i, \Sigma_i)
$$

## 2. 隐变量 $z_j$ 的引入
- $z_j$ 表示第 $j$ 个样本 $x_j$ 属于哪个高斯分量，是一个隐变量。
- $z_j = i$ 表示 $x_j$ 由第 $i$ 个分量生成。

## 3. 样本 $x_j$ 属于第 $i$ 个分量的后验概率（详细推导）

我们要求的是：在观测到样本 $x_j$ 之后，它属于第 $i$ 个高斯分量的概率，即 $P(z_j = i \mid x_j)$。

### 1. 贝叶斯公式形式

贝叶斯公式为：
$$
P(A|B) = \frac{P(B|A)P(A)}{P(B)}
$$

在这里，$A$ 表示“$x_j$ 来自第 $i$ 个分量”，$B$ 表示“观测到 $x_j$”。代入得：
$$
P(z_j = i \mid x_j) = \frac{P(x_j \mid z_j = i) \cdot P(z_j = i)}{P(x_j)}
$$

### 2. 各项含义

- $P(z_j = i)$：选择第 $i$ 个分量的先验概率，即 $\alpha_i$。
- $P(x_j \mid z_j = i)$：在第 $i$ 个分量下生成 $x_j$ 的概率密度，即 $p(x_j|\mu_i, \Sigma_i)$。
- $P(x_j)$：生成 $x_j$ 的总概率，对所有分量求和：
  $$
  P(x_j) = \sum_{l=1}^k \alpha_l \cdot p(x_j|\mu_l, \Sigma_l)
  $$

### 3. 代入贝叶斯公式

将上述各项代入贝叶斯公式，得到：
$$
P(z_j = i \mid x_j) = \frac{\alpha_i \cdot p(x_j|\mu_i, \Sigma_i)}{\sum_{l=1}^k \alpha_l \cdot p(x_j|\mu_l, \Sigma_l)}
$$

其中：
- 分子：$x_j$ 属于第 $i$ 个分量的联合概率。
- 分母：$x_j$ 的边缘概率（所有分量的联合概率之和）。

### 4. 责任度（$\gamma_{ji}$）

这个后验概率也称为“责任度”：
$$
\gamma_{ji} = P(z_j = i \mid x_j)
$$

## 4. 极大似然法的作用
- 我们希望找到一组参数 $\{\alpha_i, \mu_i, \Sigma_i\}$，使得观测数据的似然最大。
- 似然函数：
$$
LL(D) = \ln \prod_{j=1}^m p_{\mathcal{M}}(x_j) = \sum_{j=1}^m \ln \left( \sum_{i=1}^k \alpha_i p(x_j|\mu_i, \Sigma_i) \right)
$$
- 直接最大化很难（对数和在一起），所以用EM算法。

## 5. EM算法在GMM中的应用
- **E步**：用当前参数，计算每个样本属于每个分量的后验概率 $\gamma_{ji}$。
- **M步**：用 $\gamma_{ji}$ 作为“软分配”，加权更新 $\alpha_i, \mu_i, \Sigma_i$。
- 反复迭代，直到收敛。

## 6. 各符号含义
- $\alpha_i$：第 $i$ 个高斯分量的权重（先验概率），$\sum \alpha_i = 1$。
- $\mu_i$：第 $i$ 个高斯分量的均值向量。
- $\Sigma_i$：第 $i$ 个高斯分量的协方差矩阵。
- $z_j$：第 $j$ 个样本的隐变量，表示其属于哪个分量。
- $\gamma_{ji}$：第 $j$ 个样本属于第 $i$ 个分量的后验概率（责任度）。

## 7. 总结
- GMM用概率模型表达聚类，每个样本属于每个分量的概率是“软分配”。
- EM算法通过交替计算后验概率和参数更新，实现极大似然估计。
- 结果是：每个样本属于各分量的概率分布，以及每个分量的参数。

---

如需具体公式推导、代码实现或图示说明，可继续提问！
